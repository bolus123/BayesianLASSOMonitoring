#' @importFrom Rcpp evalCpp
#' @useDynLib BayesianLASSOMonitoring, .registration = TRUE
NULL
aa1 <- rarma(aa, 1000, h = 50, delta = 3)
aa1
aa$coef
aa$coef
names(aa$coef)
grep("ar", names(aa$coef))
length(grep("ar", names(aa$coef)))
grep("aa", names(aa$coef))
rarma <- function(object, n, h, delta, nsim = 100, burnin = 50, lowerbound = 0) {
nphi <- grep("ar", names(aa$coef))
ntheta <- grep("ma", names(aa$coef))
if (length(nphi) == 0) {
phi <- NULL
} else {
phi <- object$coef[nphi]
}
if (length(ntheta) == 0) {
theta <- NULL
} else {
theta <- object$coef[ntheta]
}
gamma0 <- sigma.mat(n, order = c(length(nphi), 0, length(ntheta)),
phi.vec = phi, theta.vec = theta, sigma2 = object$sigma2, burn.in = 50)$gamma0
mu <- rep(sqrt(gamma0) * delta, n)
mu[1:(h - 1)] <- 0
innov <- rnorm(n, mu, sqrt(object$sigma2))
ts <- simulate(object, nsim = n, future = FALSE, innov = innov)
ts[which(ts < lowerbound)] <- lowerbound
ts
}
debug(rarma)
aa1 <- rarma(aa, 1000, h = 50, delta = 3)
nphi
ntheta
Q
rarma <- function(object, n, h, delta, nsim = 100, burnin = 50, lowerbound = 0) {
nphi <- grep("ar", names(aa$coef))
ntheta <- grep("ma", names(aa$coef))
if (length(nphi) == 0) {
phi <- NULL
} else {
phi <- object$coef[nphi]
}
if (length(ntheta) == 0) {
theta <- NULL
} else {
theta <- object$coef[ntheta]
}
gamma0 <- sigma.mat(n = nsim, order = c(length(nphi), 0, length(ntheta)),
phi.vec = phi, theta.vec = theta, sigma2 = object$sigma2, burn.in = burnin)$gamma0
mu <- rep(sqrt(gamma0) * delta, n)
mu[1:(h - 1)] <- 0
innov <- rnorm(n, mu, sqrt(object$sigma2))
ts <- simulate(object, nsim = n, future = FALSE, innov = innov)
ts[which(ts < lowerbound)] <- lowerbound
ts
}
debug(rarma)
aa1 <- rarma(aa, 1000, h = 50, delta = 3)
gamma0
ts
ts
aa1 <- rarma(aa, 1000, h = 50, delta = 1)
undebug(rarma)
aa1 <- rarma(aa, 1000, h = 50, delta = 1)
aa1
plot(aa1)
aa1 <- rarma(aa, 1000, h = 50, delta = 0.5)
aa1
aa1 <- rarma(aa, 1000, h = 50, delta = 0)
aa1
plot(aa1)
debug(rarma)
aa1 <- rarma(aa, 1000, h = 50, delta = 0)
debug(rarma)
aa1 <- rarma(aa, 1000, h = 50, delta = 0)
aa1 <- rarma(aa, 1000, h = 50, delta = 0)
plot(aa1)
walker_METHADONE <- dat_mme_percapita[datesel, ]
walker_METHADONE <- walker_METHADONE[which((walker_METHADONE$county == "WALKER") & (walker_METHADONE$drug == "METHADONE")), ]
aa2 <- forecast::auto.arima(walker_METHADONE$mme_percapita, ic = "bic", max.P = 35, max.Q = 35, trace = TRUE)
aa2
aa2$coef
source("~/.active-rstudio-document", echo=TRUE)
rarma <- function(object, n, h, delta, nsim = 100, burnin = 50, lowerbound = 0) {
nphi <- grep("ar", names(object$coef))
ntheta <- grep("ma", names(object$coef))
if (length(nphi) == 0) {
phi <- NULL
} else {
phi <- object$coef[nphi]
}
if (length(ntheta) == 0) {
theta <- NULL
} else {
theta <- object$coef[ntheta]
}
gamma0 <- sigma.mat(n = nsim, order = c(length(nphi), 0, length(ntheta)),
phi.vec = phi, theta.vec = theta, sigma2 = object$sigma2, burn.in = burnin)$gamma0
tmpint <- grep("intercept", names(object$coef))
mu <- rep(ifelse(length(tmpint) == 0, 0, object$coef[tmpint]), n)
mu[h:n] <- mu[h:n] + sqrt(gamma0) * delta
innov <- rnorm(n, mu, sqrt(object$sigma2))
ts <- simulate(object, nsim = n, future = FALSE, innov = innov)
ts[which(ts < lowerbound)] <- lowerbound
ts
}
aa3 <- rarma(aa2, 1000, h = 50, delta = 3)
aa43
aa3
aa3 <- rarma(aa2, 1000, h = 50, delta = 1)
plot(aa3)
aa2$sigma2
aa2
aa
aa1 <- rarma(aa, 1000, h = 50, delta = 0)
plot(aa1)
aa
plot(walker_BUPRENORPHINE$mme_percapita)
cc <- BayesianLASSOMonitoring::movaver(walker_BUPRENORPHINE$mme_percapita, 7)
cc
plot(cc)
cc1 <- forecast::auto.arima(cc, ic = "bic", max.P = 35, max.Q = 35)
cc1
acf(residuals(cc1))
pacf(residuals(cc1))
acf(residuals(cc1))
?acf
acf(residuals(cc1), lag.max = 190)
acf(residuals(cc1), lag.max = 365.25)
walker_METHADONE <- dat_mme_percapita[datesel, ]
walker_METHADONE <- walker_METHADONE[which((walker_METHADONE$county == "WALKER") & (walker_METHADONE$drug == "METHADONE")), ]
aa2 <- forecast::auto.arima(walker_METHADONE$mme_percapita, ic = "bic", max.P = 35, max.Q = 35, trace = TRUE)
cc2 <- BayesianLASSOMonitoring::movaver(walker_METHADONE$mme_percapita, 7)
cc3 <- forecast::auto.arima(cc2, ic = "bic", max.P = 35, max.Q = 35)
cc2
plot(cc2)
plot(cc3)
plot(residuals(cc3))
acf(residuals(cc3))
acf(residuals(cc3), lag.max = 365.25)
acf(residuals(cc3), lag.max = 3656)
acf(residuals(cc3), lag.max = 366)
walker_BUPRENORPHINE_model <- forecast::auto.arima(walker_BUPRENORPHINE$mme_percapita, ic = "bic", max.P = 35, max.Q = 35)
walker_BUPRENORPHINE_model
save(walker_BUPRENORPHINE_model, file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
walker_METHADONE_model <- forecast::auto.arima(walker_METHADONE$mme_percapita, ic = "bic", max.P = 35, max.Q = 35, trace = TRUE)
save(walker_METHADONE_model, file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_METHADONE_model.Rdat')
aa1 <- rarma(aa, 183, h = 50, delta = 0)
aa1
cc <- BayesianLASSOMonitoring::movaver(aa1, 7)
cc
aa1 <- rarma(aa, 183 + 6, h = 50, delta = 0)
cc <- BayesianLASSOMonitoring::movaver(aa1, 7)
cc
cc <- BayesianLASSOMonitoring::movaver(aa1, 7)[-c(1:6)]
cc
?BayesianLASSOMonitoring::Ph1BayesianLASSO
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(cc, 7, H, X)
ee$model$Phi
hist(ee$model$Phi[1, ])
hist(ee$model$Phi[2, ])
hist(ee$model$Phi[3, ])
hist(ee$model$Phi[4, ])
hist(ee$model$Phi[5, ])
aa1 <- rarma(aa, 183 + 6, h = 6 + ceiling(183 / 2), delta = 0.5)
cc <- BayesianLASSOMonitoring::movaver(aa1, 7)[-c(1:6)]
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(cc, 7, H, X)
?BayesianLASSOMonitoring::Ph1BayesianLASSO
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(cc, 7, H, X, log = FALSE, sta = FALSE)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(cc, 7, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
aa1 <- rarma(aa, 183 + 6, h = 6 + ceiling(183 / 2), delta = 1)
cc <- BayesianLASSOMonitoring::movaver(aa1, 7)[-c(1:6)]
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(cc, 7, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
ee$model$Beta
ee$model$Beta * ee$model$Kappa
hist(ee$model$Beta * ee$model$Kappa)
mean(ee$model$Beta * ee$model$Kappa)
dd <- diff(cc, differences = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(dd, 7, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
H <- BayesianLASSOMonitoring::getHMatMT(182, 5)
X <- matrix(1:182, ncol = 1)
dd <- diff(cc, differences = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(dd, 7, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
mean(ee$model$Beta * ee$model$Kappa)
ee$model$Phi
hist(ee$model$Phi[1, ])
hist(ee$model$Phi[2, ])
hist(ee$model$Phi[3, ])
hist(ee$model$Phi[4, ])
hist(ee$model$Phi[5, ])
BayesianLASSOMonitoring::RMSE.ph1(ee)
?BayesianLASSOMonitoring::RMSE.ph1
BayesianLASSOMonitoring::RMSE.ph1(ee, log = FALSE, sta = FALSE)
BayesianLASSOMonitoring::RMSE.ph1(ee$model, log = FALSE, sta = FALSE)
debug(BayesianLASSOMonitoring::RMSE.ph1(ee$model, log = FALSE, sta = FALSE))
debug(BayesianLASSOMonitoring::RMSE.ph1(ee$model, log = FALSE, sta = FALSE))\
BayesianLASSOMonitoring::RMSE.ph1(ee$model, log = FALSE, sta = FALSE)
debug(BayesianLASSOMonitoring::RMSE.ph1)
BayesianLASSOMonitoring::RMSE.ph1(ee$model, log = FALSE, sta = FALSE)
X
H
BayesianLASSOMonitoring::RMSE.ph1(ee$model, log = FALSE, sta = FALSE)
Ph1BayesianLASSO.model$Beta
Ph1BayesianLASSO.model$Kappa
as.matrix(ee$model$Beta)
as.matrix(ee$model$Kappa)
roxygen2::roxygenise()
roxygen2::roxygenise()
remove.packages("BayesianLASSOMonitoring")
roxygen2::roxygenise()
devtools::install_github("bolus123/BayesianLASSOMonitoring")
devtools::install_github("bolus123/BayesianLASSOMonitoring")
remove.packages("BayesianLASSOMonitoring")
devtools::install_github("bolus123/BayesianLASSOMonitoring")
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- rarma(walker_BUPRENORPHINE_model)
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model)
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183, h = 90 + 6, delta = 10)
cc <- BayesianLASSOMonitoring::movaver(aa1, 7)[-c(1:6)]
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(dd, 7, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183 + 6, h = 90 + 6, delta = 10)
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183 + 6, h = 90 + 6, delta = 10)
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(aa1, 7, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183 + 6, h = 90 + 6, delta = 10)
Y0 <- aa1[1:6]
Y1 <- aa1[-c(1:6)]
?BayesianLASSOMonitoring::Ph1BayesianLASSO
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183 + 6, h = 90 + 6, delta = 10)
Y0 <- aa1[1:6]
Y1 <- aa1[-c(1:6)]
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 7, H, X, Y0 = Y0, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
ee$model$Phi
dimm(ee$model$Phi)
dim(ee$model$Phi)
ee$model$Phi[1, ]
ee$model$Phi[2, ]
ee$model$Phi[, 1]
ee$model$Phi[, 2]
remove.packages("BayesianLASSOMonitoring")
devtools::install_github("bolus123/BayesianLASSOMonitoring")
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183 + 6, h = 90 + 6, delta = 10)
Y0 <- aa1[1:6]
Y1 <- aa1[-c(1:6)]
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 7, H, X, Y0 = Y0, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
X
ee$model$Beta
hist(ee$model$Beta)
mean(ee$model$Beta)
mean(ee$model$Beta * ee$model$Kappa)
median(ee$model$Beta * ee$model$Kappa)
ee$model$Phi
ee$model$Phi[, 1]
ee$model$Phi[, 2]
ee$model$Phi[, 3]
ee$model$Phi[1, ]
hist(ee$model$Phi[1, ])
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183, h = 90, delta = 10)
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183, h = 90, delta = 10)
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183, h = 90, delta = 10)
Y1 <- aa1
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = Y0, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
dim(H)
length(X)
X
aa1
length(aa1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
load(file = "C:/Users/yyao17/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat")
seed <- 12345
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
object <- walker_BUPRENORPHINE_model
nnsim <- 1
TT1 <- c(183)
TT2 <- 365
w <- c(1, 7, 14, 28)
#w <- 7
q <- 5
delta <- c(0, 1)
tt <- 0.5
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
tt <- dim(pars)[1]
X <- 1
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rarma(object, n = TT1 + TT2 + w - 1, h = ceiling(TT1 * tt) + w - 1, delta = delta)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rarma(object, n = TT1 + TT2 + w - 1, h = ceiling(TT1 * tt) + w - 1, delta = delta)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
XX <- as.matrix(1:(TT1 + TT2 + 5000))
X1 <- as.matrix(XX[1:TT1, ])
X2 <- as.matrix(XX[(TT1 + 1):(TT1 + TT2), ])
X2sim <- as.matrix(XX[(TT1 + 1):(TT1 + 5000), ])
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
getChart <- function(Y1, w, H1, Y0, method,
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2) {
chart1 <- try(BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, Y0 = Y0, method = method,
const = 1, nsim.chart = 10000,
Y.hat.method = Y.hat.method, side = side, FAP0 = FAP0,
log = log, sta = sta, plot = TRUE), silent = TRUE)
out <- rep(NA, 7)
if (class(chart1) != "try-error") {
sig <- length(which(chart1$sig.tr == FALSE)) > 0
lenoverall <- which(chart1$sig.tr == FALSE)[which.min(abs(which(chart1$sig.tr == FALSE) -
(ceiling(TT1 * tt) + w - 1)))] - (ceiling(TT1 * tt) + w - 1)
if (length(lenoverall) == 0) {
lenoverall <- NA
}
lenafter <- min(which(chart1$sig.tr == FALSE)[(which(chart1$sig.tr == FALSE) -
(ceiling(TT1 * tt) + w - 1)) >= 0] - (ceiling(TT1 * tt) + w - 1))
if (length(lenafter) == 0) {
lenafter <- NA
}
tmp <- BayesianLASSOMonitoring::RMSE.ph1(chart1$model, log = log, sta = sta)
RMSE.ph1.tr <- median(tmp$RMSE.tr)
RMSE.ph1.ma <- median(tmp$RMSE.ma)
tmp <- BayesianLASSOMonitoring::RMSE.ph2(Y2, chart1$model, X2, H2, log = log, sta = sta)
RMSE.ph2.tr <- median(tmp$RMSE.tr)
RMSE.ph2.ma <- median(tmp$RMSE.ma)
out <- c(sig, lenoverall, lenafter, RMSE.ph1.tr, RMSE.ph1.ma, RMSE.ph2.tr, RMSE.ph2.ma)
}
out
}
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
debug(getChart)
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, Y0 = Y0, method = method,
const = 1, nsim.chart = 10000,
Y.hat.method = Y.hat.method, side = side, FAP0 = FAP0,
log = log, sta = sta, plot = TRUE)
Y1
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H1, X1, Y0 = Y0, log = log, sta = sta, side = "right-sided", FAP0 = FAP0)
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, Y0 = Y0, log = log, sta = sta, side = "right-sided", FAP0 = FAP0)
method
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, method = method, Y0 = Y0, log = log, sta = sta, side = "right-sided", FAP0 = FAP0)
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, method = "MT", Y0 = Y0, log = log, sta = sta, side = "right-sided", FAP0 = FAP0)
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, method = "regression", Y0 = Y0, log = log, sta = sta, side = "right-sided", FAP0 = FAP0)
BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, w, H1, X1, method = "LASSO", Y0 = Y0, log = log, sta = sta, side = "right-sided", FAP0 = FAP0)
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183, h = 90, delta = 10)
Y1 <- aa1
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
load(file = 'C:/Users/bolus/Box/2023 Summer/BayesianMonitoring/dataset/walker_BUPRENORPHINE_model.Rdat')
aa1 <- BayesianLASSOMonitoring::rarma(walker_BUPRENORPHINE_model, n = 183, h = 90, delta = 10)
Y1 <- aa1
H <- BayesianLASSOMonitoring::getHMatMT(183, 5)
X <- matrix(1:183, ncol = 1)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
debug(BayesianLASSOMonitoring::GibbsRFLSM)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
H1
dim(H1)
debug(BayesianLASSOMonitoring::GibbsRFLSM)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
debug(BayesianLASSOMonitoring::GibbsRFLSM)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
H
H
HH <- cbind(H, X)
X
HH
dim(HH)
Y
Y1
GibbsRFLSMcpp(Y1, 5, diag(1, nrow = 5), a = 0.1, b = 0.1, alpha = 0.1, beta = 0.1, theta1 = 1, theta2 = 1, xi2 = 0.1, )
GibbsRFLSMcpp(Y1, 5, diag(1, nrow = 5), a = 0.1, b = 0.1, alpha = 0.1, beta = 0.1, theta1 = 1, theta2 = 1, xi2 = 0.1, method = "MT", bound0 = Inf, boundqplus1 = 0, nsim = 10, by = 1, burnin = 10, tol = 1e-10, H = HH)
GibbsRFLSMcpp(Y1, 5, diag(1, nrow = 5), a = 0.1, b = 0.1, alpha = 0.1, beta = 0.1, theta1 = 1, theta2 = 1, xi2 = 0.1, method = "MT", bound0 = Inf, boundqplus1 = 0, nsim = 10, by = 1, burnin = 100, tol = 1e-10, H = HH)
debug(BayesianLASSOMonitoring::GibbsRFLSM)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
H1
dim(H1)
q
A
a
b
alpha
beta
theta1
theta22
theta2
method
bound0
boundqplus1
nsim
by
burnin
tol
H1
debug(BayesianLASSOMonitoring::GibbsRFLSM)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
debug(BayesianLASSOMonitoring::GibbsRFLSM)
ee <- BayesianLASSOMonitoring::Ph1BayesianLASSO(Y1, 1, H, X, Y0 = 0, method = 'MT', log = FALSE, sta = FALSE, side = "right-sided", FAP0 = 0.2)
H1
H
GibbsRFLSMcpp(Y, q, A, a, b, alpha, beta, theta1,
theta2, xi2, method, bound0, boundqplus1, nsim,
by, burnin, tol, H)
q
GibbsRFLSMcpp(Y, q, A, a, b, alpha, beta, theta1,
theta2, xi2, method, bound0, boundqplus1, nsim,
by, burnin, tol, H)
GibbsRFLSMcpp(Y, q, A, a, b, alpha, beta, theta1,
theta2, xi2, method, bound0, boundqplus1, nsim,
by, burnin, tol, H1)
GibbsRFLSMcpp(Y1, 5, diag(1, nrow = 5), a = 0.1, b = 0.1, alpha = 0.1, beta = 0.1, theta1 = 1, theta2 = 1, xi2 = 0.1, method = "MT", bound0 = Inf, boundqplus1 = 0, nsim = 10, by = 1, burnin = 100, tol = 1e-10, H = HH)
GibbsRFLSMcpp(Y1, 5, diag(1, nrow = 5), a = 0.1, b = 0.1, alpha = 0.1, beta = 0.1, theta1 = 1, theta2 = 1, xi2 = 0.1, method = "MT", bound0 = Inf, boundqplus1 = 0, nsim = 10, by = 1, burnin = 1000, tol = 1e-10, H = HH)
Y1
side
FAP0
log
sta
debug(getChart)
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
Y
Y1
HH
model <- GibbsRFLSMcpp(Y, q, A, a, b, alpha, beta, theta1,
theta2, xi2, method, bound0, boundqplus1, nsim,
by, burnin, tol, HH)
model <- GibbsRFLSMcpp(Y, 5, A, a, b, alpha, beta, theta1,
theta2, xi2, method, bound0, boundqplus1, nsim,
by, burnin, tol, HH)
model <- GibbsRFLSMcpp(Y, 5, diag(1, nrow = 5), a, b, alpha, beta, theta1,
theta2, xi2, method, bound0, boundqplus1, nsim,
by, burnin, tol, HH)
debug(getChart)
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
A
debug(getChart)
out1 <- getChart(Y1, w, H1, Y0, "MT",
Y.hat.method, side, FAP0,
log, sta, Y2, H2, tt, TT1, X1, X2)
?(BayesianLASSOMonitoring::Ph1BayesianLASSO
?BayesianLASSOMonitoring::Ph1BayesianLASSO
diag(nrow = q)
remove.packages("BayesianLASSOMonitoring")
devtools::install_github("bolus123/BayesianLASSOMonitoring")
