seed <- 12345
alpha <- c(0.03083069, 0.06242601, 0.09120189)
lambda <- 0.239385
pi <- 0.1453097
nnsim <- 100
TT1 <- c(92, 183, 365)
#TT1 <- c(92)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 0.5, 1)
tt <- 0.8
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
X <- 9
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2, alpha, lambda, pi,
ceiling(TT1 * tt), delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
H1 <- H1[, seq(1, TT1 - q, 7)]
H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
##############################################
bset <- list(
"method" = "ALASSO",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(nrow = 1),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatelambda2" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"lowerbound" = 0,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL
)
qq <- BayesianLASSOMonitoring::GibbsRFLSMX(matrix(Y1, ncol = 1), bset, H = H1,
tol = 1e-10, nsim = 300, thin = 10, burnin = 1000, verbose = 1)
pp <- BayesianLASSOMonitoring::Ph1MultipleTesting.Y01(qq, bset)
pp
pp$grandsig
pp$adj.alpha
pp$sig
365 * 0.8
ceiling(365 * 0.8)
median(qq$Phi[, 1])
median(qq$Phi[, 2])
median(qq$Phi[, 5])
median(qq$Phi[, 6])
median(qq$Phi[1, ])
median(qq$Phi[6, ])
median(qq$Phi[5, ])
pars
pars[9, ]
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
X <- 1
seed <- 12345
alpha <- c(0.03083069, 0.06242601, 0.09120189)
lambda <- 0.239385
pi <- 0.1453097
nnsim <- 100
TT1 <- c(92, 183)
#TT1 <- c(92)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 0.5, 1)
tt <- 0.8
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2 + w - 1, alpha, lambda, pi,
ceiling(TT1 * tt) + w - 1, delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
method <- :MT
method <- "MT"
?BayesianLASSOMonitoring::GibbsRFLSMX
seed <- 12345
X <- 1
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2 + w - 1, alpha, lambda, pi,
ceiling(TT1 * tt) + w - 1, delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
bset1 <- list(
"method" = "MT",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(nrow = 1),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatelambda2" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"lowerbound" = 0,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL
)
bset2 <- bset1
bset2$method <- "regression"
bset3 <- bset1
bset3$method <- "LASSO"
bset4 <- bset1
bset4$method <- "ALASSO"
bset5 <- bset1
bset5$method <- "LASSO"
bset5$phimono <- 1
bset6 <- bset1
bset6$method <- "ALASSO"
bset6$phimono <- 1
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
bset <- bset1
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
H1
dim(H1)
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
X
pars
X <- 2
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2 + w - 1, alpha, lambda, pi,
ceiling(TT1 * tt) + w - 1, delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
bset1 <- list(
"method" = "MT",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(nrow = 1),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatelambda2" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"lowerbound" = 0,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL
)
bset2 <- bset1
bset2$method <- "regression"
bset3 <- bset1
bset3$method <- "LASSO"
bset4 <- bset1
bset4$method <- "ALASSO"
bset5 <- bset1
bset5$method <- "LASSO"
bset5$phimono <- 1
bset6 <- bset1
bset6$method <- "ALASSO"
bset6$phimono <- 1
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1$Phi
?BayesianLASSOMonitoring::Ph1MultipleTesting.Y01
chart2 <- try(BayesianLASSOMonitoring::Ph1MultipleTesting.Y01(chart1, bset, FAP0 = FAP0, side = side), silent = TRUE)
chart2
chart2$grandsig
ph1pest <- rep(NA, length(Y1)- dim(chart1$Phi)[1])
Yph1 <- matrix(NA, nrow = length(Y1) - dim(chart1$Phi)[1], ncol = 10000)
Yph2 <- matrix(NA, nrow = length(Y2), ncol = 10000)
BayesianLASSOMonitoring::Ph1MultipleTesting.Y01
ph1pest
Y1
chart1$Phi
ph1pest <- rep(NA, length(Y1))
Yph1 <- matrix(NA, nrow = length(Y1), ncol = 10000)
Yph2 <- matrix(NA, nrow = length(Y2), ncol = 10000)
tmpMu1 <- H1 %*% (chart1$Gamma * chart1$Tau)
tmpMu2 <- H2 %*% (chart1$Gamma * chart1$Tau)
tmpMu2 <- rbind(tmpMu1, tmpMu2)
?BayesianLASSOMonitoring::simYph1
chart1$Y
chart1$Z
chart2$Yph1
chart2$Yph1[1, ]
chart2$Yph1[, 1]
length(chart2$Yph1[, 1])
Y
chart1$Y
chart1$Y + chart1$Z
chart1$Y + chart1$Z[, 1]
plot(chart1$Y + chart1$Z[, 1])
chart1$Z[, 1]
chart1$Y
BayesianLASSOMonitoring::yeojohnsontr(chart1$Y + chart1$Z[, 1], chart1$theta[1], 1e-6)
chart1$theta[1]
BayesianLASSOMonitoring::yeojohnsontr(chart1$Y + chart1$Z[, 1], chart1$theta[1], 1e-6)
BayesianLASSOMonitoring::yeojohnsontr(chart1$Y + chart1$Z[, 1], chart1$theta[1], 1e-6)
plot(BayesianLASSOMonitoring::yeojohnsontr(chart1$Y + chart1$Z[, 1], chart1$theta[1], 1e-6))
chart1$Y + chart1$Z[, 1]
chart1$Y
Rcpp::compileAttributes()
roxygen2::roxygenise()
roxygen2::roxygenise()
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
chart1
Mu <- chart1$mu0 + chart1$X %*% chart1$Beta + chart1$H %*% (chart1$Gamma * chart1$Tau)
chart1$H %*% (chart1$Gamma * chart1$Tau)
chart1$X %*% chart1$Beta
chart1$Beta
Mu <- chart1$mu0 + chart1$H %*% (chart1$Gamma * chart1$Tau)
chart1$mu0
Mu <- chart1$mu0[1] + chart1$H %*% (chart1$Gamma[, 1] * chart1$Tau[, 1])
Mu
simYXph1(chart1$Y, chart1$Phi[, 1],
Mu,
chart1$sigma2[1], chart1$theta[1], 1e-6,
1, 0, 1,
chart1$Z[, 1])
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
chart1$Phi[, 1]
as.matrix(chart1$Phi[, 1])
simYXph1(chart1$Y, as.matrix(chart1$Phi[, 1]),
Mu,
chart1$sigma2[1], chart1$theta[1], 1e-6,
1, 0, 1,
chart1$Z[, 1])
chart1$Y
chart1$Z[, 1]
as.matrix(chart1$Z[, 1])
simYXph1(chart1$Y, as.matrix(chart1$Phi[, 1]),
Mu,
chart1$sigma2[1], chart1$theta[1], 1e-6,
1, 0, 1,
as.matrix(chart1$Z[, 1]))
H1
H2
Mu
cat("start at X:", X, "\n")
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2 + w - 1, alpha, lambda, pi,
ceiling(TT1 * tt) + w - 1, delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
bset1 <- list(
"method" = "MT",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(nrow = 1),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatelambda2" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"lowerbound" = 0,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL
)
bset2 <- bset1
bset2$method <- "regression"
bset3 <- bset1
bset3$method <- "LASSO"
bset4 <- bset1
bset4$method <- "ALASSO"
bset5 <- bset1
bset5$method <- "LASSO"
bset5$phimono <- 1
bset6 <- bset1
bset6$method <- "ALASSO"
bset6$phimono <- 1
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
X
pars
X <- 2
cat("start at X:", X, "\n")
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2 + w - 1, alpha, lambda, pi,
ceiling(TT1 * tt) + w - 1, delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
bset1 <- list(
"method" = "MT",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(nrow = 1),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatelambda2" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"lowerbound" = 0,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL
)
bset2 <- bset1
bset2$method <- "regression"
bset3 <- bset1
bset3$method <- "LASSO"
bset4 <- bset1
bset4$method <- "ALASSO"
bset5 <- bset1
bset5$method <- "LASSO"
bset5$phimono <- 1
bset6 <- bset1
bset6$method <- "ALASSO"
bset6$phimono <- 1
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart2 <- try(BayesianLASSOMonitoring::Ph1MultipleTesting.Y01(chart1, bset, FAP0 = FAP0, side = side), silent = TRUE)
ph1pest <- rep(NA, length(Y1))
Yph1 <- matrix(NA, nrow = length(Y1), ncol = 10000)
Yph2 <- matrix(NA, nrow = length(Y2), ncol = 10000)
undebug(BayesianLASSOMonitoring::Ph1MultipleTesting.Y01)
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart2 <- try(BayesianLASSOMonitoring::Ph1MultipleTesting.Y01(chart1, bset, FAP0 = FAP0, side = side), silent = TRUE)
ph1pest <- rep(NA, length(Y1))
Yph1 <- matrix(NA, nrow = length(Y1), ncol = 10000)
Yph2 <- matrix(NA, nrow = length(Y2), ncol = 10000)
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
bset
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1 <- try(BayesianLASSOMonitoring::GibbsRFLSMX(Y1, bset, H = H1))
chart1
chart2 <- try(BayesianLASSOMonitoring::Ph1MultipleTesting.Y01(chart1, bset, FAP0 = FAP0, side = side), silent = TRUE)
chart2
?
BayesianLASSOMonitoring::Ph1MultipleTesting.Y01
remove.packages("BayesianLASSOMonitoring")
devtools::install_github("bolus123/BayesianLASSOMonitoring", "trans-and-x")
